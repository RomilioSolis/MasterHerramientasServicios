<!-- components/header.html -->
<header class="custom-header">
  <div class="container">
    <div class="header-content">
      <div class="branding text-center">
        <h1 class="brand-name mb-0">
          <a href="index.html" class="text-decoration-none">
            <span class="brand-letter">M</span>aster en 
            <span class="brand-letter">H</span>erramientas y 
            <span class="brand-letter">S</span>ervicios
          </a>
        </h1>
      </div>
    </div>
  </div>
  
  <div class="nav-section">
    <div class="container">
      <nav class="navbar navbar-expand-lg">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="#nosotros">Nosotros</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#equipos">Equipos</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#contacto">Contacto</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="container">
    <div class="search-container mx-auto" style="max-width: 600px;">
      <div class="input-group search-group">
        <input type="text" 
               id="buscadorHerramientas" 
               class="form-control search-input" 
               placeholder="Buscar herramientas..."
               aria-label="Buscador de herramientas">
        <button class="btn btn-search" type="button" aria-label="Buscar">
          <i class="fas fa-search"></i>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Solo cargar Font Awesome icons necesarios -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/solid.min.css" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/components/css/header.css" media="print" onload="this.media='all'">

<script>
// Usar IntersectionObserver para el scroll
const initHeader = () => {
  // Lazy initialization de eventos
  let scrollInitialized = false;
  let searchInitialized = false;
  
  // Inicializar scroll suave solo cuando se necesita
  const initScroll = () => {
    if (scrollInitialized) return;
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function(e) {
        if(this.hash && this.pathname === window.location.pathname) {
          e.preventDefault();
          const target = document.querySelector(this.hash);
          if(target) {
            target.scrollIntoView({behavior: 'smooth'});
          }
        }
      });
    });
    scrollInitialized = true;
  };

  // Inicializar búsqueda solo cuando el usuario interactúa
  const initSearch = () => {
    if (searchInitialized) return;
    const buscador = document.getElementById('buscadorHerramientas');
    const debounce = (fn, delay) => {
      let timeoutID;
      return function (...args) {
        if (timeoutID) clearTimeout(timeoutID);
        timeoutID = setTimeout(() => fn.apply(this, args), delay);
      };
    };

    const handleSearch = debounce((termino) => {
      if(termino.length > 2) {
        window.location.href = `index.html#equipos?search=${encodeURIComponent(termino)}`;
      }
    }, 300);

    buscador.addEventListener('input', e => handleSearch(e.target.value.trim()));
    searchInitialized = true;
  };

  // Observar elementos para inicialización lazy
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        if (entry.target.classList.contains('nav-link')) {
          initScroll();
        } else if (entry.target.id === 'buscadorHerramientas') {
          initSearch();
        }
      }
    });
  });

  // Observar elementos relevantes
  document.querySelectorAll('.nav-link').forEach(link => observer.observe(link));
  observer.observe(document.getElementById('buscadorHerramientas'));
};

// Inicializar cuando el DOM esté listo
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initHeader);
} else {
  initHeader();
}
</script>